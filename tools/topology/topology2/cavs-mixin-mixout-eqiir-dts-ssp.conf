#Define {
#        SPK_ID                          7
#        HEADSET_CODEC_NAME              'SSP0-Codec'
#        HEADSET_PLAYBACK_PCM_STREAM_NAME 'Headset Playback'
#        HEADSET_CAPTURE_PCM_STREAM_NAME 'Headset Capture'
#        HEADSET_SSP_DAI_INDEX           0
#        HEADSET_HW_CONFIG_NAME          'HEADSET HWCFG'
#        SPEAKER_CODEC_NAME              'SSP1-Codec'
#        SPEAKER_PLAYBACK_PCM_STREAM_NAME 'Speaker Playback'
#        SPEAKER_SSP_DAI_INDEX           1
#        SPEAKER_HW_CONFIG_NAME          'SPEAKER HWCFG'
#
#        HEADSET_PCM_NAME                "Headset"
#        HEADSET_PCM_ID                  0
#        SPEAKER_PCM_NAME                "Speakers"
#        SPEAKER_PCM_ID                  1
#}

#
# List of all DAIs
#
#SSP Index: 0, Direction: duplex
Object.Dai.SSP [
	{
		id 		0
		dai_index	$HEADSET_SSP_DAI_INDEX
		direction	"duplex"
		name		$HEADSET_CODEC_NAME
		default_hw_conf_id	0
		sample_bits		32
		io_clk		$MCLK

		Object.Base.hw_config.1 {
			name	$HEADSET_HW_CONFIG_NAME
			id	0
			bclk_freq	3072000
			tdm_slot_width	32
			# TODO: remove this. Needs alsaptlg change.
			Object.Base.link_config.1 {
				clock_source	1
			}
		}
	}
	{
		id 		$SPK_ID
		dai_index	$SPEAKER_SSP_DAI_INDEX
		IncludeByKey.INCLUDE_ECHO_REF {
			"false" {
				direction	"playback"
			}
			"true" {
				direction	"duplex"
				quirks		"lbm_mode"
			}
		}
		name		$SPEAKER_CODEC_NAME
		default_hw_conf_id	0
		sample_bits		32
		io_clk		$MCLK

		Object.Base.hw_config.1 {
			name	$SPEAKER_HW_CONFIG_NAME
			id	0
			bclk_freq	3072000
			tdm_slot_width	32
			# TODO: remove this. Needs alsaptlg change.
			Object.Base.link_config.1 {
				clock_source	1
			}
		}
	}
]

#
# Pipeline definitions
#
# PCM0 ---> gain ----> Mixin ----> Mixout ----> gain ----> EQ IIR ----> DTS ----> SSP0
# PCM1 ---> gain ----> Mixin ----> Mixout ----> gain ----> EQ IIR ----> DTS ----> SSP1

# Pipeline ID:1 PCM ID: 0
Object.Pipeline {
	# playback pipelines
	host-copier-gain-mixin-playback [
		{
			index	1

			Object.Widget.host-copier.1 {
				stream_name	'$HEADSET_PLAYBACK_PCM_STREAM_NAME'
				pcm_id $HEADSET_PCM_ID
			}
			Object.Widget.gain.1 {
				Object.Control.mixer.1 {
					name	'Pre Mixer $HEADSET_PCM_NAME Playback Volume'
				}
			}
		}
		{
			index	3

			Object.Widget.host-copier.1 {
				stream_name	'$SPEAKER_PLAYBACK_PCM_STREAM_NAME'
				pcm_id $SPEAKER_PCM_ID
			}
			Object.Widget.gain.1 {
				Object.Control.mixer.1 {
					name	'Pre Mixer $SPEAKER_PCM_NAME Playback Volume'
				}
			}
		}
	]

    	mixout-gain-eqiir-dts-dai-copier-playback [
    		{
    			index	2
    
    			Object.Widget.dai-copier.1 {
    				dai_index $HEADSET_SSP_DAI_INDEX
    				dai_type	"SSP"
    				copier_type	"SSP"
    				stream_name	"$HEADSET_CODEC_NAME"
    				node_type $I2S_LINK_OUTPUT_CLASS
    			}
    
    			Object.Widget.gain.1 {
    				Object.Control.mixer.1 {
    					name	'Post Mixer $HEADSET_PCM_NAME Playback Volume'
    				}
    			}
    
	                Object.Widget.eqiir.1 {
	                    Object.Control.bytes."1" {
	                        name 'EQIIR2.0 eqiir_coef_2'
	                    }
	                }
	    
	                Object.Widget.dts.1 {
	                    Object.Control.bytes."1" {
				max 2048
	                        name 'CODEC_ADAPTER2.0 DTS Codec Setup 2'
	                    }
	                }
    		}
    		{
    			index	4
    
    			Object.Widget.dai-copier.1 {
    				dai_index	$SPEAKER_SSP_DAI_INDEX
    				dai_type	"SSP"
    				copier_type	"SSP"
    				stream_name	"$SPEAKER_CODEC_NAME"
    				node_type	$I2S_LINK_OUTPUT_CLASS
    			}
    
    			Object.Widget.gain.1 {
    				Object.Control.mixer.1 {
    					name	'Post Mixer $SPEAKER_PCM_NAME Playback Volume'
    				}
    			}
    
	                Object.Widget.eqiir.1 {
	                    Object.Control.bytes."1" {
	                        name 'EQIIR1.0 eqiir_coef_1'
	                    }
	                }
	                
	                Object.Widget.dts.1 {
	                    Object.Control.bytes."1" {
				max 2048
	                        name 'CODEC_ADAPTER1.0 DTS Codec Setup 1'
	                    }
	                }
             
    		}
    	]
	host-gateway-capture [
		{
			index	5

			Object.Widget.host-copier.1 {
				stream_name	'$HEADSET_CAPTURE_PCM_STREAM_NAME'
				pcm_id $HEADSET_PCM_ID
			}
		}
	]

	io-gateway-capture [
		{
			index	6
			direction	capture

			Object.Widget.dai-copier."1" {
				dai_index	$HEADSET_SSP_DAI_INDEX
				dai_type	"SSP"
				type		dai_out
				copier_type	"SSP"
				stream_name	"$HEADSET_CODEC_NAME"
				node_type	$I2S_LINK_INPUT_CLASS
				Object.Base.input_audio_format [
					{
						in_bit_depth		32
						in_valid_bit_depth	32
					}
				]
				Object.Base.output_audio_format [
					{
						out_bit_depth		32
						out_valid_bit_depth	32
					}
				]
			}
		}
	]
}

Object.PCM.pcm [
	{
		name	"$HEADSET_PCM_NAME"
		id	$HEADSET_PCM_ID
		direction	"duplex"
		Object.Base.fe_dai.1 {
			name	"$HEADSET_PCM_NAME"
		}

		Object.PCM.pcm_caps.1 {
			direction	"playback"
			name		"$HEADSET_PLAYBACK_PCM_STREAM_NAME"
			formats	'S16_LE,S24_LE,S32_LE'
		}

		Object.PCM.pcm_caps.2 {
			direction	"capture"
			name		"$HEADSET_CAPTURE_PCM_STREAM_NAME"
			formats	'S16_LE,S24_LE,S32_LE'
		}
	}
	{
		name	"$SPEAKER_PCM_NAME"
		id	$SPEAKER_PCM_ID
		direction	"playback"
		Object.Base.fe_dai.1 {
			name	"$SPEAKER_PCM_NAME"
		}

		Object.PCM.pcm_caps.1 {
			name	"$SPEAKER_PLAYBACK_PCM_STREAM_NAME"
			formats	'S16_LE,S24_LE,S32_LE'
		}
	}
]

Object.Base.route [
	{
    		source	"gain.2.1"
    		sink	"eqiir.2.1"
    	}
    	{
    		source	"dts.2.1"
    		sink	"dai-copier.SSP.$HEADSET_CODEC_NAME.playback"
    	}
    	{
    		source	"mixin.1.1"
    		sink	"mixout.2.1"
    	}
    	{
    		source	"gain.4.1"
    		sink	"eqiir.4.1"
    	}
    	{
    		source	"dts.4.1"
    		sink	"dai-copier.SSP.$SPEAKER_CODEC_NAME.playback"
    	}
    	{
    		source	"mixin.3.1"
    		sink	"mixout.4.1"
    	}
	{
		source	"dai-copier.SSP.$HEADSET_CODEC_NAME.capture"
		sink	"host-copier.$HEADSET_PCM_ID.capture"
	}
	{
		source	"host-copier.$HEADSET_PCM_ID.playback"
		sink	"gain.1.1"
	}
	{
		source	"host-copier.$SPEAKER_PCM_ID.playback"
		sink	"gain.3.1"
	}
]
